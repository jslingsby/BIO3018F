---
title: "5. The Assembly of Diversity"
subtitle: "Local Processes"  
author: 
  - "Jasper Slingsby, BIO3018F"
date: '`r Sys.Date()`'
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      slideNumberFormat: "%current% / %total%"
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE,
  hiline = TRUE
)

library(RefManageR)
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "alphabetic",
           style = "markdown",
           hyperlink = FALSE,
           dashed = FALSE)
myBib <- ReadBib("bib/2_species.bib", check = FALSE)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)

# style_duo_accent(
#   primary_color = "#1381B0",
#   secondary_color = "#FF961C",
#   inverse_header_color = "#FFFFFF"
# )

style_mono_light(base_color = "#23395b")

#https://mycolor.space/?hex=%2323395B&sub=1 
#"Generic gradient" - #23395B #006287 #008E9D #00B897 #89DD81 #F9F871
#"Matching gradient" (reverse) - #23395B #494E77 #716292 #9C77AA #C88DBF #F5A3D0



library(knitr)
library(kableExtra)
```


```{r xaringan-tile-view, echo=FALSE}
# xaringanExtra::use_tile_view()
```

layout: false

## Diversity is not distributed evenly...

.pull-left[

```{r echo = F, fig.align = 'center', out.width = '90%'}
knitr::include_graphics("images/kreft2007_crop.jpg")
knitr::include_graphics("images/cfr_diversity.png")
``` 
.footnote[Kreft and Jetz 2007; Freiberg and Manning 2013]
]

.pull-right[

```{r echo = F, fig.align = 'center', out.width = '90%'}
knitr::include_graphics("images/cramer_verboom_2017.jpg")
```
.center[.footnote[Cramer and Verboom 2017]]
]

---

layout: false

### What determines the distribution and abundance of biodiversity?

```{r echo = F, fig.align = 'center', out.width = '100%'}
knitr::include_graphics("images/fynbos_community.jpg")
```

---

layout: false

## And how does this vary with spatial scale?

.pull-left[

```{r echo = F, fig.align = 'center', out.width = '110%'}
knitr::include_graphics("images/fynbos.jpg")
``` 

]

.pull-right[

```{r echo = F, fig.align = 'center', out.width = '61%'}
knitr::include_graphics("images/biomes.jpg")
knitr::include_graphics("images/resolv_ecoregions2017.png")
```

]

---

layout: false

.pull-left[

## Niche theory

_**In simplified terms**_ (there are a few definitions)

The niche is a multidimensional description of a species resource needs, habitat requirements and environmental tolerances 
- i.e. a particular set of abiotic (light, water, nutrient, shelter, etc) and biotic conditions (predators, prey, pathogens, mutualists (e.g. mycorrhizae, pollinators), competitors, etc)

Niche theory predicts local deterministic processes like habitat filtering, competition, facilitation, mutualisms, etc.
- These processes influence co-occurrence (limiting diversity), trait distributions and relatedness

]

.pull-right[
```{r echo = F, fig.align = 'center', out.width = '65%'}
knitr::include_graphics("images/tetraria_env.png")
```

Environmental space

```{r echo = F, fig.align = 'center', out.width = '65%'}
knitr::include_graphics("images/tetraria_trait.png")
```

Trait space (assumes that _trait ~ environment_ or resource use strategy)


]

---

layout: false

## Community assembly processes: local scale

.pull-left[

#### *Habitat filtering (or ecological sorting)*


Hypothesis:
- species with similar resource requirements (or stress tolerance) will be sorted into the same environments

Predictions:
- co-occurring species should be more functionally _**similar**_ than you'd expect by chance
- functionally similar species should co-occur _**more**_ often than you'd expect by chance



]

.pull-right[

Habitat filtering
```{r echo = F, fig.align = 'center', out.width = '90%'}
knitr::include_graphics("images/habitat_filtering.png")
```

Ecological sorting
```{r echo = F, fig.align = 'center', out.width = '90%'}
knitr::include_graphics("images/ecological_sorting.png")
```
.footnote[###### ]

]

---

layout: false

## Community assembly processes: local scale

.pull-left[

#### *Limiting similarity* and *Competitive exclusion*


Hypothesis:
- species competing for the same resources cannot stably coexist, because the stronger competitors will exclude the others

Predictions:
- co-occurring species should be more functionally _**different**_ than you'd expect by chance
- functionally similar species should co-occur _**less**_ often than you'd expect by chance



]

.pull-right[
```{r echo = F, fig.align = 'center', out.width = '65%'}
knitr::include_graphics("images/competition.png")
```

.footnote[###### ]

]

---

class: center, middle

## We now have contrasting predictions!

```{r echo = F, fig.align = 'center', out.width = '65%'}
knitr::include_graphics("images/cavender2004_traitcomp.png")
```

#### Functional clustering (low Functional Diversity) = habitat filtering

#### Functional evenness/overdispersion (high Functional Diversity) = competition

---

layout: false

## Let's test them with null models...?

```{r echo = F, fig.align = 'center', out.width = '70%'}
knitr::include_graphics("images/nullmodels.png")
```

.footnote[figure from Slingsby 2011, PhD]

---

class: center, middle

## But wait!

## There are other processes at play that can affect the outcomes...

### Especially when we expand the spatial and temporal scale...

---

layout: false

## Mode of speciation

.pull-left[

```{r echo = F, fig.align = 'left', out.width = '100%'}
knitr::include_graphics("images/speciation_mode.png")
```

> Closely-related species tend to be similar, because they share a common ancestor

]

.pull-right[

Where functional similarity reflects phylogeny:

#### Sympatric speciation (in situ speciation) 
= phylogenetic and functional clustering

#### Allopatric speciation (speciation via dispersal, isolation and drift) 
= phylogenetic and functional evenness/overdispersion

_i.e. the mode of speciation can create the same pattern as competition or habitat filtering..._
]

---

layout: false

## Assembly of species pools across scales

.pull-left[

Community assembly can be thought of as the successive filtering of species pools descending in spatial (and temporal) scale from global to local

```{r echo = F, fig.align = 'center', out.width = '100%'}
knitr::include_graphics("images/speciespools.png")
```

We often split it into **regional** versus **local** processes

.footnote[]

]

.pull-right[

_Global species pool_ = all species on the planet (or in the defined study domain, e.g. Cape Floral Region)

_Regional species pools_ = the species that are present in each region (e.g. a biogeographic region or mountain), limited by barriers to dispersal

_Fundamental species pool_ = species with the potential to occur in a particular location (i.e. can disperse there and find the appropriate abiotic conditions necessary for their
survival)

_Realised community_ = the actual observed local community (i.e. the subset of species from the fundamental species pools which have the ability to coexist, either stably or unstably)

]

---

layout: false

## Local vs Regional scale processes

The diversity of local biological communities is a balance of regional and local processes - Ricklefs 1987

.pull-left[

#### Regional scale
```{r echo = F, fig.align = 'left', out.width = '60%'}
knitr::include_graphics("images/centresofendemism.png")
```

- speciation
- extinction
- dispersal

]

.pull-right[

#### Local scale
```{r echo = F, fig.align = 'left', out.width = '90%'}
knitr::include_graphics("images/fynbos_community.jpg")
``` 

- environmental filtering
- interspecific interactions (competition, predation, pathogens, mutualisms)
- adaptation
- stochastic variation
]

---

### An example of inferring community assembly from the Cape...

.pull-left[

```{r echo = F, fig.align = 'center', out.width = '60%'}
knitr::include_graphics("images/tetraria_scales.png")
```

Three scales (pools):
- Global = Cape Floristic Region (CFR)
- Regional = Cape Peninsula (Pen)
- Local = plots within Silvermine (Silv)

.footnote[###### Slingsby 2011, PhD]

]

.pull-right[

```{r echo = F, fig.align = 'center', out.width = '60%'}
knitr::include_graphics("images/centresofendemism.png")
```

The set of species on the Peninsula and in Silvermine are more dissimilar than you'd expect relative to the CFR - _**suggests allopatric speciation**_

Species at Silvermine are more dissimilar than you'd expect relative to the Peninsula - _**suggests competition**_

Species within plots are more dissimilar than you'd expect relative to all plots - _**suggests competition**_

.footnote[###### Figure from Manning and Goldblatt 2012]

]

---

layout: false

## Community assembly processes

.pull-left[

#### Vary with spatial scale
- competition or facilitation operates between neighbouring plants
- environmental filtering operates at a range of scales (climate > soils > microsite, etc)
- biogeographic processes (speciation, extinction, vicariance, dispersal) operate across large extents

#### Vary with temporal scale
- pollination, seed dispersal or herbivory can be near-instantaneous
- speciation or trait evolution occur over long periods of time

]

.pull-right[
```{r echo = F, fig.align = 'center', out.width = '110%'}
knitr::include_graphics("images/assemblyprocesses.png")
```

.footnote[###### ]
]

---

.pull-left[

### Island Biogeography

MacArthur and Wilson 1967

]

.pull-right[

<br>

```{r echo = F, fig.align = 'center', out.width = '100%'}
knitr::include_graphics("images/island_biogeography.png")
```

.footnote[Figure from Warren et al. 2015]

]

---

.pull-left[

### An example of regional species pools from the Cape...

The phytogeographic centres of the CFR

```{r echo = F, fig.align = 'center', out.width = '100%'}
knitr::include_graphics("images/centresofendemism.png")
```

.footnote[###### Data and figure from Manning and Goldblatt 2012]

]

.pull-right[

<br>

```{r echo = F, fig.align = 'center', out.width = '100%'}
div <- read.csv("images/cfr_diversity.csv", header = T)

names(div) <- c("Region", "Area (1000 km2)", "Number of species", "Endemism (%)")

kable(div)  %>%
  kable_styling(font_size = 12) #%>%
#  row_spec(c(11:13), bold = T, color = "white", background = "#23395b")
```

The Cape phytochoria make good _Regional species pools_, but the regional pools used can be defined differently depending on the purposes of the study and if it can be justified, e.g. the Cape Peninsula is a relatively isolated biogeographic unit

CFR effectively = _Global species pool_, because of such high endemism

]


---

layout: false

## Local vs Regional scale processes

.pull-left[### Neutral Theory

Local processes (competition etc) are mostly irrelevant and local communities are the result of regional processes and dispersal limitation...]

.pull-right[
```{r echo = F, fig.align = 'center', out.width = '30%'}
knitr::include_graphics("images/Neutral_Theory_Cover.jpg")
```

Local patterns of functional and phylogenetic diversity will reflect the regional species pool

.footnote[Hubbell 2001]
]

---

layout: false

.left-column[

### What

### Happened

### Here
]

.right-column[- Latitudinal gradient, energy etc]

.footnote[<sup>1</sup>...]

---

layout: false

.left[Biogeographic processes... Global... ]

.right[- Latitudinal gradient, energy etc]

---

layout: false

Biogeographic processes... Regional... 

- Environmental heterogeneity
- Mid Domain Effect

---

layout: false

Local determinism

- competition
- facilitation
- mutualism

---

layout: false

Examples of teasing apart assembly processes?

---
class: center, middle

## Take-home

>*"..."*

---

## References

```{r refs, echo=FALSE, results="asis"}
NoCite(myBib)
PrintBibliography(myBib)
```

---
class: center, middle

# Thanks!

Slides created via the R packages:

[**xaringan**](https://github.com/yihui/xaringan)<br>
[gadenbuie/xaringanthemer](https://github.com/gadenbuie/xaringanthemer)

The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](http://yihui.name/knitr), and [R Markdown](https://rmarkdown.rstudio.com).
